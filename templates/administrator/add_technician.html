{% extends 'administrator/base.html' %}
{% load static %}
{% block title %}
<title>Welcome</title>
{% endblock %}

{% block content %}
{% if messages %}
{% for msg in messages %}
<script>
  alert('{{msg}}');
</script>
{% endfor %}
{% endif %}
<div class="parent">
<div class="container min-vh-100 d-flex align-items-center justify-content-center">
  <div class="card shadow-lg border-0 w-100" style="max-width: 510px;margin-bottom:50px">
    <div class="card-body p-4 bg-white rounded">
      <h3 class="mb-4 text-center fw-bold">Add Technician</h3>
      <form method="post" action="{% url 'administrator:add-technician' %}">
        {% csrf_token %}
        <div class="mb-3">
          <label for="product" class="form-label">Name</label>
          <input type="text" class="form-control rounded-3 shadow-sm" id="name" name="name" placeholder="Enter name"required>
        </div>
        <div class="mb-3">
            <label for="product" class="form-label">Address</label>
            <input type="text" class="form-control rounded-3 shadow-sm" id="address" name="address" placeholder="Enter address"required>
          </div>
          <div class="mb-3">
            <label for="product" class="form-label">Pincode</label>
            <input type="text" class="form-control rounded-3 shadow-sm" id="pincode" name="pincode" placeholder="Enter pincode"required maxlength="6">
          </div>
          <div class="mb-3">
            <label for="product" class="form-label">Email</label>
            <input type="text" class="form-control rounded-3 shadow-sm" id="email" name="email" placeholder="Enter email"required>
          </div>
          <div class="mb-3">
            <label for="product" class="form-label">Phone No</label>
            <input type="text" class="form-control rounded-3 shadow-sm" id="phone" name="phone" placeholder="Enter phone no"required>
          </div>
          
          <div class="mb-3">
            <label for="product" class="form-label">Qualification</label>
            <input type="text" class="form-control rounded-3 shadow-sm" id="qualification" name="qualification" placeholder="Enter qualification"required>
          </div>
          <div class="mb-3">
            <label for="product" class="form-label">Years of Exp</label>
            <input type="text" class="form-control rounded-3 shadow-sm" id="years_of_exp" name="years_of_exp" placeholder="Enter experience"required>
          </div>
        <div class="d-grid">
          <button type="submit" class="btn btn-warning btn-lg shadow-sm">Add</button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="container inner-div" style="padding-top: 60px;">
  <input type="search" placeholder="Search Technician" onkeyup="searchTechnician(this.value)">
<table class="table" id="ptable">
  <thead>
    <tr>
      <th scope="col">sl no</th>
      <th scope="col">Name</th>
      <th scope="col">Email</th>
      <th scope="col">Phone</th>
      <th scope="col">Years of Exp</th>
      <th scope="col">Edit</th>
      <th scope="col">Delete</th>
    </tr>
  </thead>
  <tbody>
   {% if technician_details.count > 0 %}
   {% for technician in technician_details %}
   <tr>
    <td>{{ forloop.counter }}</td>
    <td>{{technician.customer.user_id.first_name}}</td>
    <td>{{technician.customer.user_id.email}}</td>
    <td>{{technician.customer.phone}}</td>
    <td>{{technician.years_of_exp}}</td>
    <td><a href="{% url 'administrator:edit-technician' %}?id={{technician.id}}"><input type="button" class="btn btn-warning" value="Edit"></a></td>
    <td><a href="{% url 'administrator:delete-technician' technician.id %}"><input type="button" class="btn btn-danger" value="Delete"></a></td>
  </tr>
   {% endfor %}
   {% else %}
   <tr>
    <td colspan="7">No records to show</td>
   </tr>
   {% endif %}
  </tbody>
</table>
</div>
</div>
<script>
  function searchTechnician(product){
    var table = document.getElementById("ptable");
    var filter = product.toLowerCase();
    var row = document.getElementsByTagName("tr")
    for(var i=0;i<row.length;i++){
      var column = row[i].getElementsByTagName("td")[1];
      if(column){
        var columnvalue = column.textContent || column.innerText;
        if(columnvalue.toLowerCase().indexOf(filter) > -1){
          row[i].style.display = "";
        }
        else{
          row[i].style.display = "none";
        }
      }
      
    }

  }
</script>
{% endblock %}
